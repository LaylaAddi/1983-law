<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        @page {
            size: letter;
            margin: 1in;
            @top-center {
                content: "";
            }
            @bottom-center {
                content: "Page " counter(page) " of " counter(pages);
                font-family: 'Times New Roman', Times, serif;
                font-size: 10pt;
            }
        }

        body {
            font-family: 'Times New Roman', Times, serif;
            font-size: 12pt;
            line-height: 2;
            color: #000;
        }

        /* Draft watermark */
        {% if is_draft %}
        body::before {
            content: "DRAFT - {{ app_name }}";
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 72pt;
            color: rgba(200, 200, 200, 0.3);
            z-index: -1;
            white-space: nowrap;
        }
        {% endif %}

        /* Court caption */
        .court-caption {
            text-align: center;
            margin-bottom: 24pt;
            line-height: 1.5;
        }

        .court-name {
            font-weight: bold;
            text-transform: uppercase;
            font-size: 12pt;
            margin-bottom: 18pt;
        }

        .case-caption-box {
            border: 2px solid black;
            padding: 12pt 18pt;
            margin: 18pt auto;
            text-align: left;
            max-width: 450pt;
        }

        .party-line {
            margin-bottom: 3pt;
        }

        .party-label {
            margin-left: 24pt;
            margin-bottom: 6pt;
        }

        .vs-line {
            text-align: center;
            font-weight: bold;
            margin: 12pt 0;
        }

        .case-number {
            text-align: right;
            margin-top: 12pt;
            font-style: italic;
        }

        .document-title {
            text-align: center;
            font-weight: bold;
            text-transform: uppercase;
            text-decoration: underline;
            margin: 24pt 0;
            font-size: 12pt;
        }

        /* Section headers */
        .section-header {
            text-align: center;
            font-weight: bold;
            text-decoration: underline;
            margin-top: 24pt;
            margin-bottom: 12pt;
        }

        /* Section content - preserve whitespace and formatting */
        .section-content {
            white-space: pre-wrap;
            font-family: 'Times New Roman', Times, serif;
            font-size: 12pt;
            line-height: 2;
        }

        /* Cause of action styling */
        .cause-of-action {
            margin-top: 18pt;
        }

        /* Signature block - try to keep with preceding content */
        .signature-block {
            margin-top: 48pt;
            margin-left: 50%;
            page-break-inside: avoid;
        }

        .signature-block .section-content {
            line-height: 1.5;
        }

        /* Keep signature with jury demand or prayer if possible */
        .signature-wrapper {
            page-break-inside: avoid;
        }

        /* Page break hints */
        .section-break {
            page-break-before: auto;
        }

        /* Reduce orphans/widows for better page utilization */
        p, .section-content {
            orphans: 3;
            widows: 3;
        }

        /* Footer for draft */
        {% if is_draft %}
        .draft-footer {
            position: fixed;
            bottom: 0.5in;
            left: 0;
            right: 0;
            text-align: center;
            font-size: 9pt;
            color: #999;
        }
        {% endif %}
    </style>
</head>
<body>
    {% if is_draft %}
    <div class="draft-footer">
        DRAFT DOCUMENT - Generated by {{ app_name }} - For Review Only
    </div>
    {% endif %}

    <!-- Court Caption -->
    <div class="court-caption">
        <div class="court-name">
            UNITED STATES DISTRICT COURT<br>
            {{ document_data.district|default:"" }} DISTRICT OF {{ document_data.state_name|default:document_data.incident.state|upper }}
        </div>

        <div class="case-caption-box">
            <div class="party-line">{{ document_data.plaintiff.first_name|upper }} {{ document_data.plaintiff.last_name|upper }},</div>
            <div class="party-label">Plaintiff,</div>
            <div class="vs-line">v.</div>
            {% for defendant in document_data.defendants %}
            <div class="party-line">{{ defendant.name|upper }}{% if defendant.title_rank %}, {{ defendant.title_rank }}{% endif %}{% if not forloop.last %},{% else %},{% endif %}</div>
            {% empty %}
            <div class="party-line">[DEFENDANTS],</div>
            {% endfor %}
            <div class="party-label">Defendant{% if document_data.defendants|length > 1 %}s{% endif %}.</div>
            <div class="case-number">Case No. ________________</div>
        </div>

        <div class="document-title">
            COMPLAINT FOR VIOLATION OF CIVIL RIGHTS<br>
            PURSUANT TO 42 U.S.C. ยง 1983
        </div>
    </div>

    <!-- Introduction -->
    <div class="section-content">{{ document.final_introduction }}</div>

    <!-- Jurisdiction and Venue -->
    <div class="section-header">JURISDICTION AND VENUE</div>
    <div class="section-content">{{ document.final_jurisdiction }}</div>

    <!-- Parties -->
    <div class="section-header">PARTIES</div>
    <div class="section-content">{{ document.final_parties }}</div>

    <!-- Statement of Facts -->
    <div class="section-header">STATEMENT OF FACTS</div>
    <div class="section-content">{{ document.final_facts }}</div>

    <!-- Causes of Action -->
    <div class="section-header">CAUSES OF ACTION</div>
    {% for cause in document.final_causes_of_action %}
    <div class="cause-of-action">
        <div class="section-content">{{ cause.content }}</div>
    </div>
    {% endfor %}

    <!-- Prayer for Relief -->
    <div class="section-header">PRAYER FOR RELIEF</div>
    <div class="section-content">{{ document.final_prayer }}</div>

    <!-- Jury Demand + Signature - try to keep together -->
    <div class="signature-wrapper">
        {% if document.final_jury_demand %}
        <div class="section-header">JURY DEMAND</div>
        <div class="section-content">{{ document.final_jury_demand }}</div>
        {% endif %}

        <!-- Signature Block -->
        <div class="signature-block">
            <div class="section-content">{{ document.final_signature }}</div>
        </div>
    </div>
</body>
</html>
