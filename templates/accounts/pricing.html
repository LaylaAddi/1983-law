{% extends 'base.html' %}
{% load static %}

{% block title %}Pricing - {{ header_app_name }}{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/public-pages.css' %}">
<style>
    .pricing-card {
        border: 2px solid #e9ecef;
        border-radius: 12px;
        padding: 2rem;
        height: 100%;
        transition: all 0.3s ease;
        background: white;
    }
    .pricing-card:hover {
        border-color: var(--patriot-blue);
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    .pricing-card.featured {
        border-color: var(--patriot-blue);
        position: relative;
    }
    .pricing-card.featured::before {
        content: 'Most Popular';
        position: absolute;
        top: -12px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--patriot-blue);
        color: white;
        padding: 4px 16px;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 600;
    }
    .price-amount {
        font-size: 3rem;
        font-weight: 700;
        color: var(--patriot-blue);
    }
    .price-period {
        color: #6c757d;
        font-size: 1rem;
    }
    .pricing-features {
        list-style: none;
        padding: 0;
        margin: 1.5rem 0;
    }
    .pricing-features li {
        padding: 0.5rem 0;
        border-bottom: 1px solid #f1f1f1;
    }
    .pricing-features li:last-child {
        border-bottom: none;
    }
    .pricing-features i {
        color: #28a745;
        margin-right: 8px;
    }
    .pricing-features .text-muted i {
        color: #6c757d;
    }
    .section-divider {
        text-align: center;
        margin: 3rem 0;
        position: relative;
    }
    .section-divider::before {
        content: '';
        position: absolute;
        top: 50%;
        left: 0;
        right: 0;
        height: 1px;
        background: #e9ecef;
    }
    .section-divider span {
        background: #f8f9fa;
        padding: 0 1rem;
        position: relative;
        color: #6c757d;
        font-weight: 600;
    }
    .savings-badge {
        background: #d4edda;
        color: #155724;
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
    }
</style>
{% endblock %}

{% block main_class %}{% endblock %}

{% block content %}

<!-- Hero Section -->
<section class="hero-section" style="padding: 3rem 0;">
    <div class="container text-center">
        <h1>Simple, Transparent Pricing</h1>
        <p class="lead">
            Choose the plan that works for you. No hidden fees, no surprises.
        </p>
    </div>
</section>

<!-- Subscription Plans -->
<section class="section-light py-5">
    <div class="container">
        <h2 class="text-center mb-2">Subscription Plans</h2>
        <p class="text-center text-muted mb-5">Unlimited documents for active auditors</p>

        <div class="row justify-content-center g-4">
            <!-- Monthly Plan -->
            <div class="col-md-5 col-lg-4">
                <div class="pricing-card">
                    <div class="text-center mb-4">
                        <h3>Monthly Pro</h3>
                        <div class="price-amount">${{ price_monthly|floatformat:0 }}</div>
                        <div class="price-period">per month</div>
                    </div>
                    <ul class="pricing-features">
                        <li><i class="bi bi-check-circle-fill"></i> <strong>Unlimited</strong> documents</li>
                        <li><i class="bi bi-check-circle-fill"></i> {{ monthly_ai_uses }} AI assists/month</li>
                        <li><i class="bi bi-check-circle-fill"></i> Cancel anytime</li>
                        <li><i class="bi bi-check-circle-fill"></i> PDF downloads</li>
                        <li><i class="bi bi-check-circle-fill"></i> Priority support</li>
                    </ul>
                    {% if has_subscription %}
                        <a href="{% url 'accounts:subscription_manage' %}" class="btn btn-outline-primary w-100">
                            Manage Subscription
                        </a>
                    {% else %}
                        <a href="{% url 'accounts:subscribe' plan='monthly' %}" class="btn btn-outline-primary w-100">
                            Start Monthly
                        </a>
                    {% endif %}
                </div>
            </div>

            <!-- Annual Plan -->
            <div class="col-md-5 col-lg-4">
                <div class="pricing-card featured">
                    <div class="text-center mb-4">
                        <h3>Annual Pro</h3>
                        <div class="price-amount">${{ price_annual|floatformat:0 }}</div>
                        <div class="price-period">per year <span class="savings-badge ms-2">Save $99</span></div>
                        <small class="text-muted">${{ price_annual_per_month|floatformat:2 }}/month</small>
                    </div>
                    <ul class="pricing-features">
                        <li><i class="bi bi-check-circle-fill"></i> <strong>Unlimited</strong> documents</li>
                        <li><i class="bi bi-check-circle-fill"></i> <strong>Unlimited</strong> AI assists</li>
                        <li><i class="bi bi-check-circle-fill"></i> Cancel anytime</li>
                        <li><i class="bi bi-check-circle-fill"></i> PDF downloads</li>
                        <li><i class="bi bi-check-circle-fill"></i> Priority support</li>
                        <li><i class="bi bi-check-circle-fill"></i> <strong>2 months free</strong></li>
                    </ul>
                    {% if has_subscription %}
                        <a href="{% url 'accounts:subscription_manage' %}" class="btn btn-primary w-100">
                            Manage Subscription
                        </a>
                    {% else %}
                        <a href="{% url 'accounts:subscribe' plan='annual' %}" class="btn btn-primary w-100">
                            Start Annual
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>

        <div class="section-divider">
            <span>OR PAY PER DOCUMENT</span>
        </div>

        <h2 class="text-center mb-2">One-Time Purchases</h2>
        <p class="text-center text-muted mb-5">Perfect for single cases</p>

        <div class="row justify-content-center g-4">
            <!-- Single Document -->
            <div class="col-md-5 col-lg-4">
                <div class="pricing-card">
                    <div class="text-center mb-4">
                        <h3>Single Document</h3>
                        <div class="price-amount">${{ price_single|floatformat:0 }}</div>
                        <div class="price-period">one-time</div>
                    </div>
                    <ul class="pricing-features">
                        <li><i class="bi bi-check-circle-fill"></i> 1 complete document</li>
                        <li><i class="bi bi-check-circle-fill"></i> $5 AI assistance budget</li>
                        <li><i class="bi bi-check-circle-fill"></i> 45 days to complete</li>
                        <li><i class="bi bi-check-circle-fill"></i> PDF download</li>
                        <li><i class="bi bi-check-circle-fill"></i> Email support</li>
                    </ul>
                    <a href="{% url 'accounts:register' %}" class="btn btn-outline-primary w-100">
                        Get Started
                    </a>
                </div>
            </div>

            <!-- 3-Pack -->
            <div class="col-md-5 col-lg-4">
                <div class="pricing-card">
                    <div class="text-center mb-4">
                        <h3>3-Document Pack</h3>
                        <div class="price-amount">${{ price_3pack|floatformat:0 }}</div>
                        <div class="price-period">one-time <span class="savings-badge ms-2">Save $48</span></div>
                        <small class="text-muted">${{ price_3pack_per|floatformat:0 }} per document</small>
                    </div>
                    <ul class="pricing-features">
                        <li><i class="bi bi-check-circle-fill"></i> <strong>3</strong> complete documents</li>
                        <li><i class="bi bi-check-circle-fill"></i> $5 AI budget per document</li>
                        <li><i class="bi bi-check-circle-fill"></i> 45 days each to complete</li>
                        <li><i class="bi bi-check-circle-fill"></i> PDF downloads</li>
                        <li><i class="bi bi-check-circle-fill"></i> Email support</li>
                    </ul>
                    <a href="{% url 'accounts:register' %}" class="btn btn-outline-primary w-100">
                        Get 3-Pack
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Free Tier Info -->
<section class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card border-0 shadow-sm">
                    <div class="card-body p-4">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h4><i class="bi bi-gift text-primary me-2"></i>Try Before You Buy</h4>
                                <p class="mb-0 text-muted">
                                    Start documenting your case for free. You get <strong>{{ free_ai_uses }} free AI assists</strong>
                                    to help you get started. Only pay when you're ready to generate your final document.
                                </p>
                            </div>
                            <div class="col-md-4 text-md-end mt-3 mt-md-0">
                                <a href="{% url 'accounts:register' %}" class="btn btn-primary">
                                    Start Free <i class="bi bi-arrow-right ms-1"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Promo Code Section -->
<section class="section-light py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-6 text-center">
                <h4><i class="bi bi-ticket-perforated me-2"></i>Have a Promo Code?</h4>
                <p class="text-muted">
                    Get {{ promo_discount }}% off your first payment with a referral code from a friend or content creator.
                </p>
                {% if user.is_authenticated %}
                <p class="small text-muted">
                    Enter your promo code during checkout to apply the discount.
                </p>
                {% else %}
                <a href="{% url 'accounts:register' %}" class="btn btn-outline-primary">
                    Sign Up to Use Code
                </a>
                {% endif %}
            </div>
        </div>
    </div>
</section>

<!-- FAQ -->
<section class="py-5">
    <div class="container">
        <h2 class="text-center mb-5">Frequently Asked Questions</h2>
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="accordion" id="pricingFaq">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                Can I cancel my subscription anytime?
                            </button>
                        </h2>
                        <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#pricingFaq">
                            <div class="accordion-body">
                                Yes! You can cancel your subscription at any time. You'll continue to have access until the end of your current billing period.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                What happens to my documents if I cancel?
                            </button>
                        </h2>
                        <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#pricingFaq">
                            <div class="accordion-body">
                                Your documents remain accessible for viewing and downloading. You just won't be able to create new documents or use AI assistance until you resubscribe or purchase a document pack.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                What does "AI assists" mean?
                            </button>
                        </h2>
                        <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#pricingFaq">
                            <div class="accordion-body">
                                AI assists help you fill out sections of your complaint document. The AI can help analyze your story, suggest relevant legal claims, look up addresses, and more. Each AI interaction counts as one use.
                            </div>
                        </div>
                    </div>
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                                Do you offer refunds?
                            </button>
                        </h2>
                        <div id="faq4" class="accordion-collapse collapse" data-bs-parent="#pricingFaq">
                            <div class="accordion-body">
                                Due to the digital nature of our service, we generally don't offer refunds. However, if you experience technical issues, please contact us and we'll work to resolve them.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}
